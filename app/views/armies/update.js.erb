const checkbox_status = $('#id_army_<%= @army.id %>').is(":checked");

$('#army_<%= @army.id %>').html('<%= j render "row", army: @army  %>');

$('#army_<%= @army.id %>').addClass("table-highlight", callback )

function callback() {
  setTimeout(function() {
    $('#army_<%= @army.id %>').removeClass( "table-highlight" );
  }, 500 );
}

<% @new_unit_ids&.each do |unit_id| %>
  $('#unit_' + <%= unit_id %>).remove();
<% end %>

<% @removed_unit_ids&.each do |unit_id| %>
  <% unit = Unit.find_by(id: unit_id) %>
  $('#unit_list').find('tbody').append('<tr id="unit_<%= unit.id.to_s %>"></tr>');
  $('#unit_<%= unit.id %>').html('<%= j render "units/row", unit: unit  %>');

  $('#unit_<%= unit.id %>').addClass("table-highlight");
  setTimeout(function() {
    $('#unit_<%= unit.id %>').removeClass("table-highlight");
  }, 500);
<% end %>

$("#flash").html('<%= j render partial: "layouts/alert" %>');

$("#id_army_<%= @army.id %>").prop("checked", checkbox_status);

$(".modal").modal('hide');

initPopovers();
$('.selectpicker').selectpicker();
$.fn.table_sorter();
$.fn.checkbox_listeners();
$.fn.inline_listeners();
$.fn.mass_edit_buttons('units');
$.fn.mass_edit_buttons('armies');
